module tests.complex_constraints @ 1.0.0

pub gen OrderedList {
    has items: Vec<Int64>

    // Simple rule
    rule non_empty {
        this.items.length() > 0
    }

    // Forall rule
    rule sorted {
        forall i: UInt64.
            i < this.items.length() - 1 implies
                this.items[i] <= this.items[i + 1]
    }

    // Exists rule
    rule has_positive {
        exists x: Int64. x in this.items && x > 0
    }

    // Nested quantifiers
    rule unique {
        forall i: UInt64. forall j: UInt64.
            i != j implies this.items[i] != this.items[j]
    }

    // Complex implication chain
    rule bounded {
        this.items.length() > 0 implies (
            forall x: Int64. x in this.items implies (
                x >= this.min() && x <= this.max()
            )
        )
    }
}

pub trait Ordered {
    is compare(other: Self) -> Int64

    law reflexive {
        forall x: Self. x.compare(x) == 0
    }

    law antisymmetric {
        forall x: Self. forall y: Self.
            x.compare(y) <= 0 && y.compare(x) <= 0 implies
                x.compare(y) == 0
    }

    law transitive {
        forall x: Self. forall y: Self. forall z: Self.
            x.compare(y) <= 0 && y.compare(z) <= 0 implies
                x.compare(z) <= 0
    }
}

docs {
    Tests for complex constraints with quantifiers and implications.
}
